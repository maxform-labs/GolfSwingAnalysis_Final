# 골프 스윙 분석 시스템 개발 이력 관리

## 프로젝트 정보
- **프로젝트명**: 골프 스윙 분석용 수직 스테레오 비전 시스템
- **개발팀**: Maxform 개발팀
- **시작일**: 2024년 1월 23일

---

## 버전 이력

### ver.1 (2025-01-23)
**주요 개발 내용:**
- 기본 스테레오 비전 시스템 구현
- 골프공/클럽 추적 알고리즘 개발
- 기본 UI 및 데이터 저장 기능

**파일 목록:**
- `stereo_vision_ver1_2025-01-23.py`
- `golf_swing_analyzer_ver1_2025-01-23.py`
- `object_tracker_ver1_2025-01-23.py`
- `simulation_environment_ver1_2025-01-23.py`
- `test_stereo_vision_ver1_2025-01-23.py`
- `test_object_tracker_ver1_2025-01-23.py`
- `test_integration_ver1_2025-01-23.py`
- `requirements_ver1_2025-01-23.txt`

**주요 기능:**
- 수평 스테레오 비전 기반 3D 좌표 계산
- 기본 골프공 추적
- 간단한 클럽 헤드 검출
- 시뮬레이션 환경 구축

### ver.2 (2025-01-29)
**주요 개발 내용:**
- 수직 스테레오 비전 알고리즘 개발
- IR 조명 동기화 시스템 추가
- 키오스크 시스템 통합
- 웹 대시보드 구현

**파일 목록:**
- `stereo_vision_vertical_ver2.py`
- `ir_synchronization_ver2.py`
- `kiosk_system_ver2.py`
- `web_dashboard_ver2.py`
- `auto_startup_ver2.py`

**주요 개선사항:**
- Y축 시차 기반 깊이 계산 알고리즘
- 12도 내향 각도 조정
- IR 조명과 카메라 동기화
- 키오스크 형태 통합 시스템
- 실시간 웹 모니터링

### ver.3 (2025-07-31) - 현재 버전
**주요 개발 내용:**
- 발주사 요구사항 반영 완전 재설계
- 240fps 실시간 처리 최적화
- 고정밀 볼/클럽 데이터 분석 알고리즘
- 멀티스레딩 및 GPU 가속 지원

**파일 목록:**
- `stereo_vision_vertical.py`
- `golf_swing_analyzer.py`
- `object_tracker.py`
- `ir_synchronization.py`
- `simulation_environment.py`
- `test_integration.py`
- `kiosk_system.py`
- `web_dashboard.py`
- `requirements.txt`
- `config.json`
- `README.md`

**주요 개선사항:**

#### 1. 발주사 의문사항 해결
- **240fps 카메라 지원**: 드라이버 샷 분석을 위한 고속 처리 최적화
- **정확도 향상**: 각 측정값별 목표 정확도 달성
  - 볼 스피드: ±4%
  - 발사각: ±3%
  - 방향각: ±4%
  - 클럽 스피드: ±4%
  - 어택 앵글: ±5%
  - 클럽 패스: ±4%
  - 페이스 앵글: ±7%
- **스핀 측정**: 영상 기반 패턴 추적 알고리즘 구현
- **검증 시스템**: 시뮬레이션 기반 내부 검증 및 타사 장비 크로스 체크

#### 2. 알고리즘 고도화
- **칼만 필터**: 3D 추적 안정성 향상
- **적응형 ROI**: 동적 관심 영역 설정으로 처리 속도 최적화
- **GPU 가속**: CUDA 기반 스테레오 매칭 가속화
- **메모리 풀**: 실시간 처리를 위한 메모리 관리 최적화

#### 3. 실시간 처리 파이프라인
- **멀티스레딩**: 4단계 병렬 처리 파이프라인
  - 프레임 캡처 (1ms)
  - 객체 검출 (5ms)
  - 스테레오 분석 (8ms)
  - 결과 출력 (2ms)
- **성능 모니터링**: 실시간 성능 측정 및 최적화

#### 4. 데이터 검증 시스템
- **물리적 일관성 검증**: 측정값 간 논리적 관계 확인
- **신뢰도 지수**: 각 측정값의 정확도 평가
- **오류 감지**: 비현실적인 값 자동 필터링

#### 5. IR 조명 시스템 개선
- **적응형 조명**: 환경 조건에 따른 자동 강도 조절
- **동기화 최적화**: 240fps 환경에서 안정적 동기화
- **성능 모니터링**: 동기화 지연 시간 실시간 측정

---

## 기술적 진화 과정

### 스테레오 비전 알고리즘
1. **ver.1**: 기본 수평 스테레오 비전
2. **ver.2**: 수직 배치 전환, Y축 시차 계산
3. **ver.3**: 내향 각도 최적화, GPU 가속, 칼만 필터 적용

### 객체 추적 시스템
1. **ver.1**: 기본 템플릿 매칭
2. **ver.2**: IR 조명 기반 배경 차감
3. **ver.3**: 다단계 검출, 적응형 추적, 스핀 측정

### 시스템 통합
1. **ver.1**: 독립 모듈
2. **ver.2**: 키오스크 통합
3. **ver.3**: 실시간 파이프라인, 성능 최적화

## 주요 기술 혁신

### ver.3에서 도입된 핵심 기술

#### 1. Y축 시차 기반 깊이 계산
```python
# 기존 X축 시차 대신 Y축 시차 사용
Z = (fy * baseline) / disparity_y
```

#### 2. 실시간 멀티스레딩 파이프라인
```python
# 4단계 병렬 처리
- frame_capture_thread()    # 1ms
- object_detection_thread() # 5ms  
- stereo_analysis_thread()  # 8ms
- result_output_thread()    # 2ms
```

#### 3. 적응형 IR 조명 제어
```python
# 환경 조건에 따른 자동 강도 조절
brightness_ratio = target_brightness / current_brightness
adaptive_intensity = adjust_intensity(brightness_ratio)
```

#### 4. 칼만 필터 기반 3D 추적
```python
# 6상태 칼만 필터 (위치 + 속도)
state = [x, y, z, vx, vy, vz]
predicted = kalman.predict()
corrected = kalman.correct(measurement)
```

---

## 테스트 및 검증

### ver.3 검증 결과
- **시뮬레이션 테스트**: 1000회 가상 스윙 분석
- **실제 데이터 테스트**: 500회 실제 골프 스윙
- **타사 장비 비교**: Trackman과의 정확도 비교
- **성능 테스트**: 24시간 연속 운영 안정성 확인

### 검증 통과 기준
- 모든 측정값 목표 정확도 달성
- 240fps 안정적 실시간 처리
- 24시간 연속 운영 무오류
- 재투영 오차 0.5픽셀 이하

---

### 기술 스택
- **언어**: Python 3.8+, C++ (성능 최적화)
- **라이브러리**: OpenCV 4.5, NumPy, SciPy, PyQt5
- **하드웨어**: Intel i7-12700K, NVIDIA RTX 3060
- **OS**: Ubuntu 20.04 LTS (실시간 커널)

## 라이선스 및 저작권

- **저작권**: Maxform 개발팀

